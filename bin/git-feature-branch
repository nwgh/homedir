#!/bin/sh

if [[ -z "$1" ]] ; then
    echo "Usage: git feature-branch <branchname>"
    exit 1
fi

cd /Users/hurley/src/mozilla
git clone m-c "$1"
cd "$1"
cp ../m-c/.ycm_extra_conf.py .
git remote rm origin
git remote add origin git@github.com:todesschaf/mozilla-central.git
git remote add mozilla git://github.com/mozilla/mozilla-central
git fetch --all
branch="wip/$1"
if git branch -a | grep -q "remotes/origin/$branch" ; then
    echo "Checking out existing branch $branch"
    git checkout "$branch"
else
    echo "Creating new branch $branch"
    git checkout -b "$branch" mozilla/master
    git push -u origin "$branch"
fi
